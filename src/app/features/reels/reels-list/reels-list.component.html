<div class="reels-root white-theme" *ngIf="!loading && !error">
  <div class="reel-container">
    <div *ngFor="let reel of reels; let i = index" class="reel">
      <div class="reel-inner">

        <div class="video-wrapper" (click)="togglePlayPause(i)">
          <video
            #videoEl
            class="reel-video"
            [src]="reel.mediaVideoUrl"
            loop muted playsinline preload="metadata"
            (dblclick)="$event.stopPropagation(); onVideoDoubleTap(i)">
          </video>

          <div class="heart-pop" *ngIf="heartVisible[i]"></div>
          <div class="floating-hearts"></div>

          <button title="mute" class="mute-btn" (click)="$event.stopPropagation(); togglePlayPause(i)">
            <svg viewBox="0 0 24 24" class="mute-icon" xmlns="http://www.w3.org/2000/svg">
              <path d="M5 9v6h4l5 4V5L9 9H5z" fill="currentColor"></path>
            </svg>
          </button>
        </div>

        <div class="overlay"></div>

        <div class="reel-info">
          <div class="user">
            <img alt="reel" [src]="reel.reelUser?.profileImage || profilePlaceholder()" class="profile-img" />
            <div class="meta">
              <div class="username">@{{ reel.reelUser?.username }}</div>
              <div class="music">ğŸµ {{ reel.caption || 'Original audio' }}</div>
            </div>
          </div>
          <p class="caption" *ngIf="reel.caption">{{ reel.caption }}</p>
        </div>

        <div class="actions">
          <button class="icon-btn like-btn" (click)="likeReel(reel, i)">
            <svg class="icon" viewBox="0 0 24 24" [attr.fill]="reel.likedByMe ? 'currentColor' : 'none'">
              <path stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"
                    d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
            </svg>
            <span class="count">{{ reel.likeCount || 0 }}</span>
          </button>

          <button class="icon-btn" (click)="commentReel(reel)">
            ğŸ’¬
            <span class="count">{{ reel.commentCount || 0 }}</span>
          </button>

          <button class="icon-btn" (click)="reshareReel(reel)">
            ğŸ”
            <span class="count">{{ reel.reshareCount || 0 }}</span>
          </button>

          <button class="icon-btn" (click)="shareReel(reel)">ğŸ“¤</button>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="loading" class="loading-screen">Loading Reels...</div>
<div *ngIf="error" class="error-screen">{{ error }}</div>
